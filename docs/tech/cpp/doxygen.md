---
tags:
  - cpp
---

::: info Introduction

钦定了，可以说，这是标准的cpp文档生成工具。

:::

写文档是一个复杂和重要的事情，一个好的项目可能要花费编写代码的时间的1/3来写文档。

doxygen 从源码注释中生成文档，它和c++匹配良好，支持markdown，支持dot plantuml 生成图表。

## 配合cmake 使用

这是一个简单的例子：

文件tree:


```
.
├── build
│   ├── CMakeCache.txt
│   ├── cmake_install.cmake
│   ├── docs
│   │   ├── cmake_install.cmake
│   │   ├── Doxyfile
│   │   └── Makefile
│   ├── Makefile
│   └── src
│       ├── cmake_install.cmake
│       └── Makefile
├── CMakeLists.txt
├── docs
│   ├── CMakeLists.txt
│   ├── Doxyfile.in
│   └── manual
│       ├── index2.md
│       ├── index.md
│       └── readme.md
└── src
    ├── CMakeLists.txt
    ├── doxygen_test.hpp
    └── main.cpp
```
docs/CMakeLists.txt:

```cmake
find_program(DOXYGEN_PATH doxygen REQUIRED)

if(DOXYGEN_PATH_NOTFOUND)
  message(FATAL_ERROR "Doxygen is needed to build the
documentation. Please install it on your system")
else()
  message(STATUS "Doxygen found.")

  include(FetchContent)
  FetchContent_Declare(
    doxygen-awesome-css
    URL https://github.com/jothepro/doxygen-awesome-css/archive/refs/heads/main.zip
  )
  FetchContent_MakeAvailable(doxygen-awesome-css)

  # Save the location the files were cloned into This allows us to get the path
  # to doxygen-awesome.css
  FetchContent_GetProperties(doxygen-awesome-css SOURCE_DIR AWESOME_CSS_DIR)

  # Generate the Doxyfile
  set(DOXYFILE_IN ${CMAKE_CURRENT_SOURCE_DIR}/Doxyfile.in)
  set(DOXYFILE_OUT ${CMAKE_CURRENT_BINARY_DIR}/Doxyfile)
  configure_file(${DOXYFILE_IN} ${DOXYFILE_OUT} @ONLY)

  add_custom_target(
    docs
    COMMAND ${DOXYGEN_PATH} ${CMAKE_CURRENT_BINARY_DIR}/Doxyfile
    WORKING_DIRECTORY ${CMKAE_CURRENT_BINARY_DIR})
  add_custom_command(
    TARGET docs
    POST_BUILD
    COMMAND
      echo
      "Documentation successfully generated. You can preview at: ${CMAKE_BINARY_DIR}/docs/html/index.html"
  )
endif()

```
src/doxygen_test.hpp: 

```cpp
#include <iostream>
namespace DoxygenTest {
/**
 * @class A
 * @brief A class 这是一个父类
 *
 */
class A {
public:
  /**
   * @brief 这是一个构造函数
   */
  A() {}
  /**
   * @brief 这是一个虚函数
   *
   * @param a 一个整数
   * @param b 另一个整数
   * @return a+b 返回两个整数的和
   */
  virtual int add(int a, int b) = 0;
};
/**
 * @class B
 * @brief B class 这是一个子类,继承自A
 *
 */
class B : A {
public:
  /**
   * @brief 这是一个构造函数
   * ## 这是一个markdown的标题
   *
   * \`\`\`cpp
   * // 这是一个代码块
   * int main() {
   * std::cout << "Hello World!";
   * }
   *
   * \`\`\`
   */
  B() {}
  /**
   * @brief 这是一个重写的函数
   *
   * @param a 一个整数
   * @param b 一个整数
   * @return a+b 返回两个整数的和
   */
  int add(int a, int b) override { return a + b; }
  /**
   * @brief  print Hi!!!
   */
  void print() { std::cout << "Hi!"; }
};

} // namespace DoxygenTest

```
写注释很累，也很消耗时间。

我用了doxygen-awesome 来美化文档。

Doxygen.in 借助cmake的configure_file 来生成Doxyfile。可以使用`doxygen -g Doxyfile`来生成一个模板的Doxyfile。

Doxyfile的配置项很多。 这里列出一些重要的

```
# The PROJECT_NAME tag is a single word (or a sequence of words surrounded by
# double-quotes, unless you are using Doxywizard) that should identify the
# project for which the documentation is generated. This name is used in the
# title of most generated pages and in a few other places.
# The default value is: My Project.

PROJECT_NAME           = "DoxygenTest"

# The OUTPUT_LANGUAGE tag is used to specify the language in which all
# documentation generated by Doxygen is written. Doxygen will use this
# information to generate all constant output in the proper language.
# Possible values are: Afrikaans, Arabic, Armenian, Brazilian, Bulgarian,
# Catalan, Chinese, Chinese-Traditional, Croatian, Czech, Danish, Dutch, English
# (United States), Esperanto, Farsi (Persian), Finnish, French, German, Greek,
# Hindi, Hungarian, Indonesian, Italian, Japanese, Japanese-en (Japanese with
# English messages), Korean, Korean-en (Korean with English messages), Latvian,
# Lithuanian, Macedonian, Norwegian, Persian (Farsi), Polish, Portuguese,
# Romanian, Russian, Serbian, Serbian-Cyrillic, Slovak, Slovene, Spanish,
# Swedish, Turkish, Ukrainian and Vietnamese.
# The default value is: English.

OUTPUT_LANGUAGE        = Chinese


# If the EXTRACT_ALL tag is set to YES, Doxygen will assume all entities in
# documentation are documented, even if no documentation was available. Private
# class members and static file members will be hidden unless the
# EXTRACT_PRIVATE respectively EXTRACT_STATIC tags are set to YES.
# Note: This will also disable the warnings about undocumented members that are
# normally produced when WARNINGS is set to YES.
# The default value is: NO.

EXTRACT_ALL            = YES

# The INPUT tag is used to specify the files and/or directories that contain
# documented source files. You may enter file names like myfile.cpp or
# directories like /usr/src/myproject. Separate the files or directories with
# spaces. See also FILE_PATTERNS and EXTENSION_MAPPING
# Note: If this tag is empty the current directory is searched.

INPUT                  = @CMAKE_CURRENT_LIST_DIR@/../src @CMAKE_CURRENT_LIST_DIR@/manual/

# The RECURSIVE tag can be used to specify whether or not subdirectories should
# be searched for input files as well.
# The default value is: NO.

RECURSIVE              = YES

# If the GENERATE_HTML tag is set to YES, Doxygen will generate HTML output
# The default value is: YES.

GENERATE_HTML          = YES

# The HTML_OUTPUT tag is used to specify where the HTML docs will be put. If a
# relative path is entered the value of OUTPUT_DIRECTORY will be put in front of
# it.
# The default directory is: html.
# This tag requires that the tag GENERATE_HTML is set to YES.

HTML_OUTPUT            =html

# The HTML_EXTRA_STYLESHEET tag can be used to specify additional user-defined
# cascading style sheets that are included after the standard style sheets
# created by Doxygen. Using this option one can overrule certain style aspects.
# This is preferred over using HTML_STYLESHEET since it does not replace the
# standard style sheet and is therefore more robust against future updates.
# Doxygen will copy the style sheet files to the output directory.
# Note: The order of the extra style sheet files is of importance (e.g. the last
# style sheet in the list overrules the setting of the previous ones in the
# list).
# Note: Since the styling of scrollbars can currently not be overruled in
# Webkit/Chromium, the styling will be left out of the default doxygen.css if
# one or more extra stylesheets have been specified. So if scrollbar
# customization is desired it has to be added explicitly. For an example see the
# documentation.
# This tag requires that the tag GENERATE_HTML is set to YES.

HTML_EXTRA_STYLESHEET  = @AWESOME_CSS_DIR@/doxygen-awesome.css


#---------------------------------------------------------------------------
# Configuration options related to the LaTeX output
#---------------------------------------------------------------------------

# If the GENERATE_LATEX tag is set to YES, Doxygen will generate LaTeX output.
# The default value is: YES.

GENERATE_LATEX         = NO

# The LATEX_OUTPUT tag is used to specify where the LaTeX docs will be put. If a
# relative path is entered the value of OUTPUT_DIRECTORY will be put in front of
# it.
# The default directory is: latex.
# This tag requires that the tag GENERATE_LATEX is set to YES.

LATEX_OUTPUT           = latex


# If you set the HAVE_DOT tag to YES then Doxygen will assume the dot tool is
# available from the path. This tool is part of Graphviz (see:
# https://www.graphviz.org/), a graph visualization toolkit from AT&T and Lucent
# Bell Labs. The other options in this section have no effect if this option is
# set to NO
# The default value is: NO.

HAVE_DOT               = YES


# The OUTPUT_DIRECTORY tag is used to specify the (relative or absolute) path
# into which the generated documentation will be written. If a relative path is
# entered, it will be relative to the location where Doxygen was started. If
# left blank the current directory will be used.

OUTPUT_DIRECTORY       =

```

配置项真多。

## neovim 插件

语法高亮 tree-sitter 是支持doxygen的。

还有插件:

```lua
  {
    "danymat/neogen",
    config = true,
    lazy = false,
    -- Uncomment next line if you want to follow only stable versions
    -- version = "*"
  }

  map({"n","i"}, "<c-_>",function ()
    require('neogen').generate()
  end,{desc = "neogen comments!"})
  map({"n","i"}, "<c-/>",function ()
    require('neogen').generate()
  end,{desc = "neogen comments!"})
```

支持快速生成格式话的doxygen注释。

## 其它

doxygen 不可替代的特性是从源码中提取注释生成文档。当然它也支持单独的markdown文件。

有很多其它的工具可以用来写文档:

`sphinx`: python生态。doxygen 可以生成xml文件，sphinx可以从xml文件中生成文档。它的生态很好。它的reStructuredText语法相比markdown，有更强的表现力。

`vitepress`: 此网站就是这个。js生态。自定义能力更强，和doxygen 没有配合。
